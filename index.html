<!DOCTYPE html><html lang="de" class="preload"><head><meta name="x-poe-datastore-behavior" content="local_only"><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <script>
      document.documentElement.classList.add('preload');
    </script>

    <style>
      html.preload body { visibility: hidden; }

      html.preload #loading-screen {
        visibility: visible !important;
        display: flex !important;
        position: fixed;
        inset: 0;
        z-index: 9999;
      }

      #loading-screen { display: none; }
    </style>



    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Hub - Professionelles Projektmanagement by LFG</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Chart.js f√ºr Visualisierungen -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- jsPDF f√ºr PDF-Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Frappe Gantt f√ºr Zeitplan-Visualisierung -->
    <script src="https://cdn.jsdelivr.net/npm/frappe-gantt@0.6.1/dist/frappe-gantt.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/frappe-gantt@0.6.1/dist/frappe-gantt.min.css">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&amp;family=Work+Sans:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #fafafa;
            --bg-tertiary: #f0f0f0;
            --text-primary: #000000;
            --text-secondary: #525252;
            --text-tertiary: #737373;
            --border-color: #e5e5e5;
            --accent-color: #000000;
            --shadow: rgba(0, 0, 0, 0.08);
            --success: #16a34a;
            --warning: #ea580c;
            --danger: #dc2626;
            --info: #2563eb;
        }

        .dark {
            --bg-primary: #0a0a0a;
            --bg-secondary: #141414;
            --bg-tertiary: #1f1f1f;
            --text-primary: #fafafa;
            --text-secondary: #a3a3a3;
            --text-tertiary: #737373;
            --border-color: #262626;
            --accent-color: #ffffff;
            --shadow: rgba(255, 255, 255, 0.05);
        }

        body {
            font-family: 'Work Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: background-color 0.2s ease, color 0.2s ease;
            line-height: 1.6;
        }

        .font-mono {
            font-family: 'IBM Plex Mono', 'Courier New', monospace;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--text-tertiary);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }

        /* Buttons */
        .btn {
            padding: 0.625rem 1.25rem;
            font-size: 0.875rem;
            font-weight: 500;
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.15s ease;
            border-radius: 0.375rem;
        }

        .btn:hover {
            background: var(--bg-secondary);
            border-color: var(--text-secondary);
        }

        .btn-primary {
            background: var(--accent-color);
            color: var(--bg-primary);
            border-color: var(--accent-color);
        }

        .dark .btn-primary {
            background: var(--accent-color);
            color: var(--bg-primary);
        }

        .btn-primary:hover {
            opacity: 0.85;
        }
        .btn-danger {
            background: var(--danger);
            color: #ffffff;
            border-color: var(--danger);
        }

        .btn-danger:hover {
            opacity: 0.9;
        }

        /* Input Fields */
        input, select, textarea {
            width: 100%;
            padding: 0.625rem;
            font-size: 16px;
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
            color: var(--text-primary);
            border-radius: 0.375rem;
            transition: all 0.15s ease;
        }

        /* Multi-Select (Kostenart) ‚Äì optisch wie Input */
        .ms-details { position: relative; }
        .ms-details > summary { list-style: none; }
        .ms-details > summary::-webkit-details-marker { display: none; }

        .ms-summary {
            width: 100%;
            padding: 0.5rem 0.625rem !important;   /* vorher 0.625rem -> neu kompakter */
            line-height: 1.1;           /* optional: kompakter */
            font-size: 16px;
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
            color: var(--text-primary);
            border-radius: 0.375rem;
            transition: all 0.15s ease;
            cursor: pointer;

            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 0.5rem;
        }


        .ms-details[open] .ms-summary {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px var(--shadow);
        }

        .ms-caret { opacity: 0.7; }

        /* Fix: Options-Layout (Checkbox + Label links) */
        .ms-panel {
          text-align: left !important;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px var(--shadow);
        }

        .input-readonly {
          opacity: 0.85;
          cursor: not-allowed;
        }

        /* Cards */
        .card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1.5rem;
            transition: all 0.15s ease;
        }

        .card:hover {
            box-shadow: 0 4px 12px var(--shadow);
        }

        /* Status Lights */
        .status-light {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 0.5rem;
        }

        .status-light.green {
            background: var(--success);
            box-shadow: 0 0 8px var(--success);
        }

        .status-light.yellow {
            background: var(--warning);
            box-shadow: 0 0 8px var(--warning);
        }

        .status-light.red {
            background: var(--danger);
            box-shadow: 0 0 8px var(--danger);
        }

        /* Tabs */
        .tab-button {
            padding: 0.75rem 1.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            background: transparent;
            color: var(--text-secondary);
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .tab-button:hover {
            color: var(--text-primary);
        }

        .tab-button.active {
            color: var(--text-primary);
            border-bottom-color: var(--accent-color);
        }

        /* Global Navigation */
        .nav-button {
            padding: 0.625rem 1.25rem;
            font-size: 0.875rem;
            font-weight: 600;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .nav-button:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .nav-button.active {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        .dark .nav-button.active {
            background: var(--accent-color);
            color: var(--bg-primary);
            border-color: var(--accent-color);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }

        .modal-content {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
        }

        /* NEW: Wide modal variant for team member selection and resource-heavy dialogs */
        .modal-content-wide {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            max-width: 80%;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
        }

        /* Gantt Chart Container */
        #gantt-container {
            width: 100%;
            height: 500px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            overflow: hidden;
        }

        .gantt-bar {
            height: 30px;
            border-radius: 4px;
            position: absolute;
            cursor: pointer;
            display: flex;
            align-items: center;
            padding: 0 8px;
            font-size: 12px;
            white-space: nowrap;
            overflow: hidden;
        }

        .gantt-task {
            background: var(--info);
            color: white;
        }

        .gantt-milestone {
            background: var(--warning);
            color: white;
        }

        /* Table */
        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            text-align: left;
            padding: 0.75rem;
            font-weight: 600;
            font-size: 0.875rem;
            border-bottom: 2px solid var(--border-color);
            background: var(--bg-tertiary);
        }

        td {
            padding: 0.75rem;
            border-bottom: 1px solid var(--border-color);
        }

        tr:hover {
            background: var(--bg-tertiary);
        }

        /* Kostenliste: dezente Hinterlegung je Kostenart */
        .cost-row.cost-type-Internal { background: rgba(22, 163, 74, 0.06); }
        .cost-row.cost-type-external { background: rgba(37, 99, 235, 0.06); }
        .cost-row.cost-type-investment { background: rgba(234, 179, 8, 0.08); }

        /* Dark Mode */
        body.dark .cost-row.cost-type-Internal { background: rgba(22, 163, 74, 0.18); }
        body.dark .cost-row.cost-type-external { background: rgba(37, 99, 235, 0.20); }
        body.dark .cost-row.cost-type-investment { background: rgba(234, 179, 8, 0.22); }

        /* Wichtig: globale tr:hover-Farbe nicht √ºber die Typ-Farbe legen */
        .cost-row:hover { background: inherit; }

        /* Subtiler Gruppentrenner bei Wechsel der Kostenart */
        .cost-row.cost-group-start td {
          border-top: 2px solid rgba(0, 0, 0, 0.08);
        }

        body.dark .cost-row.cost-group-start td {
          border-top: 2px solid rgba(255, 255, 255, 0.10);
        }

        /* Click-to-Edit: klickbare Tabellenzeilen */
        .clickable-row {
            cursor: pointer;
        }

        /* Dezentes Hover-Feedback */
        .clickable-row:hover {
            filter: brightness(0.98);
        }

        body.dark .clickable-row:hover {
            filter: brightness(1.08);
        }


        /* Loading State */
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid var(--border-color);
            border-top-color: var(--accent-color);
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Utility Classes */
        .hidden { display: none !important; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .gap-4 { gap: 1rem; }
        .gap-6 { gap: 1.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mt-4 { margin-top: 1rem; }
        .p-4 { padding: 1rem; }
        .p-6 { padding: 1.5rem; }
        .text-sm { font-size: 0.875rem; }
        .text-lg { font-size: 1.125rem; }
        .text-xl { font-size: 1.25rem; }
        .text-2xl { font-size: 1.5rem; }
        .font-bold { font-weight: 700; }
        .font-semibold { font-weight: 600; }
        .font-medium { font-weight: 500; }
        .grid { display: grid; }
        .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
        .row-expander {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          width: 1.8rem;
          font-size: 1.5rem;   /* gr√∂√üer */
          font-weight: 900;    /* fetter */
          line-height: 1;
          cursor: pointer;
          user-select: none;
          color: var(--text-secondary);
          transition: transform 0.15s ease, color 0.15s ease;
        }

        .row-expander:hover {
          color: var(--text-primary);
        }

        /* ZU = horizontal (rechts) */
        .row-expander.is-collapsed {
          transform: rotate(-90deg);
        }

        /* AUF = nach unten */
        .row-expander.is-expanded {
          transform: rotate(0deg);
        }



        /* Gantt Critical Path Styling */
        .gantt-critical-path .bar {
            stroke: var(--danger) !important;
            stroke-width: 3px !important;
            fill: var(--danger) !important;
            opacity: 0.8;
        }

        .gantt-critical-path .bar-progress {
            fill: var(--danger) !important;
            opacity: 1;
        }

        .gantt .bar {
            transition: all 0.2s ease;
        }

        .gantt .bar:hover {
            opacity: 0.9;
            filter: brightness(1.1);
        }

        /* Today-Linie im Gantt */
        .gantt .today-highlight {
            fill: rgba(0, 0, 0, 0.08) !important;
            stroke: rgba(0, 0, 0, 0.6) !important;
            stroke-width: 2px !important;
            stroke-dasharray: 4, 4 !important;
        }

        /* Gates im Gantt */
        .gantt .bar-wrapper.gantt-milestone .bar {
            fill: #dc2626 !important;
            stroke: #991b1b !important;
            stroke-width: 2px !important;
            rx: 0 !important;
            transform: rotate(45deg);
            transform-origin: center;
        }
        .gantt .bar-wrapper.gantt-milestone .bar-progress {
            fill: #b91c1c !important;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .grid-cols-2, .grid-cols-3 {
                grid-template-columns: 1fr;
            }
        }
        .app-footer {
            border-top: 1px solid #e5e7eb;
            margin-top: 2rem;
            padding: 0.75rem 1.5rem;
            font-size: 0.85rem;
            color: var(--text-secondary, #6b7280);
            background: #f9fafb;
        }
        .app-footer-inner {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            gap: 1rem;
            align-items: center;
        }
        .app-footer a {
            color: inherit;
            text-decoration: underline;
        }
        @media (max-width: 640px) {
            .app-footer-inner {
                flex-direction: column;
                align-items: flex-start;
            }
        }
        /* Vollfl√§chige Lade-Seite (Splash Screen) */
        #loading-screen {
            position: fixed;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-primary);
            z-index: 9999;
        }

        #loading-screen.hidden {
            display: none;
        }

        .loading-inner {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.75rem;
            text-align: center;
            padding: 1.5rem;
        }

        .loading-logo {
            width: 96px;
            height: auto;
            margin-bottom: 0.5rem;
        }

        .loading-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .loading-subtitle {
            font-size: 0.875rem;
            color: var(--text-secondary);
            max-width: 22rem;
        }

        .loading-spinner {
            margin-top: 1rem;
            width: 40px;
            height: 40px;
            border-radius: 9999px;
            border: 4px solid var(--border-color);
            border-top-color: var(--accent-color);
            animation: loading-spin 0.8s linear infinite;
        }

        @keyframes loading-spin {
            from { transform: rotate(0deg); }
            to   { transform: rotate(360deg); }
        }

        /* ============================
           Kostenart Multi-Select ‚Äì final stabil gekapselt
           ============================ */

        #costs-type-filter {
          position: relative;
          display: block;
          width: 100%;
        }

        #costs-type-filter > summary { list-style: none; }
        #costs-type-filter > summary::-webkit-details-marker { display: none; }
        
        #costs-type-filter .ms-summary {
          width: 100%;
          padding: 0.5rem 0.625rem;       /* kompakter als Input-Default */
          font-size: 16px;
          border: 1px solid var(--border-color);
          background: var(--bg-primary);
          color: var(--text-primary);
          border-radius: 0.375rem;
          cursor: pointer;

          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 0.5rem;
          box-sizing: border-box;
        }

        #costs-type-filter[open] .ms-summary {
          border-color: var(--accent-color);
          box-shadow: 0 0 0 2px var(--shadow);
        }

        #costs-type-filter .ms-panel {
          position: absolute;
          top: calc(100% + 0.5rem);
          left: 0;
          width: 100%;
          z-index: 50;

          padding: 0.75rem;
          border: 1px solid var(--border-color);
          background: var(--bg-primary);
          border-radius: 0.5rem;
          box-shadow: 0 10px 20px rgba(0,0,0,0.12);
          box-sizing: border-box;

          display: flex;
          flex-direction: column;
          gap: 0.5rem;

          text-align: left;               /* Panel-Inhalt links */
        }

        #costs-type-filter .ms-row {
            display: grid !important;
            grid-template-columns: auto 1fr !important; /* Checkbox | Text */
            align-items: center !important;
            justify-content: start !important;
            column-gap: 0.5rem !important;

            width: 100% !important;
            text-align: left !important;
        }

    </style>
</head>
<body style="visibility:hidden;">
    <!-- Vollfl√§chige Lade-Seite -->
    <div id="loading-screen">
        <div class="loading-inner">
            <img src="assets/LFG.png" alt="LFG Logo" class="loading-logo">
            <div class="loading-title">Project Hub wird geladen ‚Ä¶</div>
            <div class="loading-subtitle">
                Verbindung zu Microsoft herstellen & Projektdaten laden.
            </div>
            <div class="loading-spinner"></div>
        </div>
    </div>
    <!-- Header -->
    <div id="app-root">
        <header style="border-bottom: 1px solid var(--border-color); padding: 1rem 2rem;">
	        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
	            <div>
	                <h1 class="text-2xl font-bold font-mono">Project Hub</h1>
	                <p class="text-sm" style="color: var(--text-secondary);">Ressourcen &amp; Projektsteuerung</p>
	            </div>
	            <button id="theme-toggle" class="btn">
	                <span id="theme-icon">üåô</span>
	            </button>
	        </div>
	
	        <!-- Global Navigation -->
	        <nav style="display: flex; gap: 0.5rem; margin-top: 1rem;">
	            <button class="nav-button active" data-view="projects" onclick="UI.switchGlobalView('projects')">
	                üìä Projekte
	            </button>
	            <button class="nav-button" data-view="portfolio" onclick="UI.switchGlobalView('portfolio')">
	                üìà √úbersicht Projekte
	            </button>
	            <button class="nav-button" data-view="team" onclick="UI.switchGlobalView('team')">
	                üë• Mitarbeiter
	            </button>
	        </nav>
	    </header>
	
	    <!-- Main Container -->
	    <div style="max-width: 1400px; margin: 0 auto; padding: 2rem;">
	
	        <!-- View: Project List -->
	        <div id="view-project-list">
	            <div class="flex" style="justify-content: space-between; align-items: center; margin-bottom: 2rem;">
	                <h2 class="text-xl font-bold">Alle Projekte</h2>
	                <div class="flex gap-4">
	                    <button id="btn-export-all-projects-pdf" class="btn">üìÑ Management-PDF Export</button>
	                    <!--<button id="btn-load-demo-data" class="btn" style="background: #059669; color: white;">üìä Demo-Daten laden</button>-->
	                    <button id="btn-new-project" class="btn btn-primary">+ Neues Projekt</button>
	                </div>
	            </div>
	
	            <!-- Filters -->
	            <div class="card mb-6">
	                <div class="grid grid-cols-3 gap-4">
	                    <div>
	                        <label class="text-sm font-medium">Projektleiter</label>
	                        <select id="filter-lead">
	                            <option value="">Alle</option>
	                        </select>
	                    </div>
	                    <div>
	                        <label class="text-sm font-medium">Status</label>
	                        <select id="filter-status">
	                            <option value="">Alle</option>
	                            <option value="green">üü¢ Gr√ºn</option>
	                            <option value="yellow">üü° Gelb</option>
	                            <option value="red">üî¥ Rot</option>
	                        </select>
	                    </div>
	                    <div>
	                        <label class="text-sm font-medium">Phase</label>
	                        <select id="filter-phase">
	                            <option value="">Alle</option>
	                        </select>
	                    </div>
	                </div>
	            </div>
	
	            <!-- Project Cards -->
	            <div id="project-cards-container" class="grid grid-cols-2 gap-6">
	                <!-- Dynamic content -->
	            </div>
	        </div>

        <!-- View: Global Team Management -->
        <div id="view-global-team" class="hidden">
            <div class="flex" style="justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <div>
                    <h2 class="text-xl font-bold">Team &amp; Ressourcen</h2>
                    <p class="text-sm" style="color: var(--text-secondary); margin-top: 0.25rem;">
                        Globale Verwaltung aller Ressourcen und deren Auslastung
                    </p>
                </div>
                <button class="btn btn-primary" onclick="UI.showAddMemberModal()">+ Neues Teammitglied</button>
            </div>

            <!-- Team Members Table -->
            <div class="card" style="margin-bottom: 2rem;">
                <h3 class="font-semibold mb-4">Alle Teammitglieder</h3>
                <table id="global-team-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Rolle</th>
                            <th>Kompetenzgruppe</th>
                            <th>Stundensatz</th>
                            <th>Anstellungsgrad</th>
                            <th>Effektive Kapazit√§t</th>
                            <th>Aktuelle Auslastung</th>
                            <th>Status</th>
                            <th>Aktionen</th>
                        </tr>
                    </thead>
					<tbody>
                        <!-- Dynamic content -->
                    </tbody>
                </table>
            </div>

            <!-- Global Capacity Overview -->
            <div class="card">
                <h3 class="font-semibold mb-4">Globale Kapazit√§ts√ºbersicht</h3>
                <div id="global-capacity-overview">
                    <!-- Dynamic content -->
                </div>
            </div>

            <!-- Competency Group Utilization -->
            <div class="card mt-6">
                <h3 class="font-semibold mb-4">Auslastung nach Kompetenzgruppe</h3>
                <div id="competency-group-overview">
                    <!-- Dynamic content -->
                </div>
            </div>
        </div>

        <!-- View: Portfolio Gantt -->
        <div id="view-portfolio-gantt" class="hidden">
            <div class="flex" style="justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <div>
                    <h2 class="text-xl font-bold">√úbersicht Projekte (Gantt)</h2>
                    <p style="color: var(--text-secondary); margin-top: 0.5rem;">
                        Globale √úbersicht aller Projekte mit FTE-Allokation und √úberlast-Warnungen
                    </p>
                </div>
            </div>

            <!-- Portfolio KPIs -->
            <div class="grid gap-4 mb-6" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                <div class="card">
                    <div class="text-sm" style="color: var(--text-secondary);">Aktive Projekte</div>
                    <div class="text-2xl font-bold font-mono mt-1" id="portfolio-active-projects">0</div>
                </div>
                <div class="card">
                    <div class="text-sm" style="color: var(--text-secondary);">Gesamt FTE allokiert</div>
                    <div class="text-2xl font-bold font-mono mt-1" id="portfolio-total-fte">0.0</div>
                </div>
                <div class="card">
                    <div class="text-sm" style="color: var(--text-secondary);">Verf√ºgbare FTE</div>
                    <div class="text-2xl font-bold font-mono mt-1" id="portfolio-available-fte">0.0</div>
                </div>
                <div class="card">
                    <div class="text-sm" style="color: var(--text-secondary);">√úberlastete Zeitr√§ume</div>
                    <div class="text-2xl font-bold font-mono mt-1" style="color: var(--danger);" id="portfolio-overload-periods">0</div>
                </div>
            </div>

            <!-- Portfolio Gantt Chart -->
            <div class="card">
                <h3 class="font-semibold mb-4">Projekte Gantt</h3>
                <div id="portfolio-gantt-container" style="overflow-x: auto; overflow-y: visible;">
                    <!-- Gantt chart will be rendered here -->
                </div>
            </div>

            <!-- Project Details Table -->
            <div class="card mt-6">
                <h3 class="font-semibold mb-4">Projekt-Details</h3>
                <table id="portfolio-projects-table">
                    <thead>
                        <tr>
                            <th>Projekt</th>
                            <th>Projektleiter</th>
                            <th>Start</th>
                            <th>Ende</th>
                            <th>Dauer</th>
                            <th>Durchschn. FTE</th>
                            <th>Phase</th>
                            <th>Warnungen</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Dynamic content -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- View: Project Details -->
        <div id="view-project-details" class="hidden">
            <div class="flex" style="justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <button id="btn-back-to-list" class="btn">‚Üê Zur√ºck zur √úbersicht</button>
                <div class="flex gap-4">
                    <button id="btn-edit-project" class="btn">‚úèÔ∏è Bearbeiten</button>
                    <button id="btn-archive-project" class="btn" style="background: var(--warning); color: white;">
                        üì¶ Archivieren
                    </button>
                </div>
            </div>

            <!-- Project Header -->
            <div id="project-header" class="card mb-6">
                <!-- Dynamic content -->
            </div>

            <!-- Tabs -->
            <div style="border-bottom: 1px solid var(--border-color); margin-bottom: 2rem;">
                <button class="tab-button active" data-tab="overview">√úbersicht</button>
                <button class="tab-button" data-tab="costs">Kosten</button>
                <button class="tab-button" data-tab="milestones">Gates</button>
                <button class="tab-button" data-tab="risks">Risiken</button>
                <button class="tab-button" data-tab="tasks">Aufgaben</button>
                <button class="tab-button" data-tab="gantt">Gantt-Zeitplan</button>
                <button class="tab-button" data-tab="team">Team</button>
                <button class="tab-button" data-tab="resources">Ressourcen</button>
            </div>

            <!-- Tab Contents -->
            <div id="tab-overview" class="tab-content">
                <div class="grid grid-cols-2 gap-6 mb-6">
                    <div class="card">
                        <h3 class="font-semibold mb-4">KPIs</h3>
                        <div id="project-kpis"></div>
                    </div>
                    <div class="card">
                        <h3 class="font-semibold mb-4">Budget-√úbersicht</h3>
                        <canvas id="budget-chart"></canvas>
                    </div>
                </div>
            </div>

            <div id="tab-costs" class="tab-content hidden">
                <!-- Budget Overview Container -->
                <div id="budget-overview-container"></div>

                <div class="flex" style="justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h3 class="text-lg font-semibold">Kostendetails (IST-Erfassung)</h3>
                    <button id="btn-add-cost" class="btn btn-primary">+ Kosten erfassen</button>
                </div>
                <!-- Filter & Suche (Kosten) -->
                <div class="card mb-4" style="padding: 1rem;">
                  <div class="grid gap-3" style="grid-template-columns: 1.5fr 1fr auto;">
                    <div>
                        <label class="text-sm font-medium">Suche</label>
                        <input id="costs-search" type="text" placeholder="Beschreibung / Bestell-/Rechnungsnr. / Betrag" />
                    </div>

                    <div>
                        <label class="text-sm font-medium">Kostenart</label>

                        <details id="costs-type-filter" class="ms-details">
                            <summary id="costs-type-summary" class="ms-summary">
                                <span id="costs-type-filter-label">Alle</span>
                                <span class="ms-caret">‚ñæ</span>
                            </summary>

                            <div class="ms-panel">
                              <div class="ms-row">
                                <input type="checkbox" class="cost-type-cb" value="Internal_hours" id="ct-Internal">
                                <label for="ct-Internal">Selbstgeschaffene Entwicklungskosten</label>
                              </div>

                              <div class="ms-row">
                                <input type="checkbox" class="cost-type-cb" value="external_service" id="ct-external">
                                <label for="ct-external">Erworbene Entwicklungskosten</label>
                              </div>

                              <div class="ms-row">
                                <input type="checkbox" class="cost-type-cb" value="investment" id="ct-investment">
                                <label for="ct-investment">Spezialwerkzeuge / Modelle</label>
                              </div>
                            </div>
                        </details>
                    </div>

                    <div style="display:flex; flex-direction:column; justify-content:flex-end; gap:0.5rem;">
                        <button id="costs-filter-reset" class="btn">Zur√ºcksetzen</button>
                    </div>
                </div>

                </div>

                <div class="card">
                    <table id="costs-table">
                        <thead>
                            <tr>
                                <th>
                                  <span style="display:inline-flex; gap:.35rem; align-items:center;">
                                    Datum
                                    <button type="button" class="costs-sort-btn" data-sort-key="date"
                                            title="Sortieren nach Datum"
                                            style="all:unset; cursor:pointer; opacity:.85;">
                                      <span class="sort-icon" data-sort-icon-for="date">‚áÖ</span>
                                    </button>
                                  </span>
                                </th>
                                <th>Beschreibung</th>
                                <th>Bestell-/Rechnungsnr.</th>
                                <th>Kostenart</th>
                                <th>
                                  <span style="display:inline-flex; gap:.35rem; align-items:center;">
                                    Status
                                    <button type="button" class="costs-sort-btn" data-sort-key="status"
                                            title="Sortieren nach Status"
                                            style="all:unset; cursor:pointer; opacity:.85;">
                                      <span class="sort-icon" data-sort-icon-for="status">‚áÖ</span>
                                    </button>
                                  </span>
                                </th>
                                <th>Betrag </th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Dynamic content -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="tab-milestones" class="tab-content hidden">
                <div class="flex" style="justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h3 class="text-lg font-semibold">Gates</h3>
                    <button id="btn-add-milestone" class="btn btn-primary">+ Gate hinzuf√ºgen</button>
                </div>
                <div id="milestones-container" class="grid gap-4">
                    <!-- Dynamic content -->
                </div>
            </div>

            <div id="tab-risks" class="tab-content hidden">
                <div class="flex" style="justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h3 class="text-lg font-semibold">Risikomanagement</h3>
                    <button id="btn-add-risk" class="btn btn-primary">+ Risiko erfassen</button>
                </div>
                <div id="risks-container" class="grid gap-4">
                    <!-- Dynamic content -->
                </div>
            </div>

            <div id="tab-tasks" class="tab-content hidden">
                <div class="flex" style="justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h3 class="text-lg font-semibold">Aufgaben &amp; N√§chste Schritte</h3>
                    <button id="btn-add-task" class="btn btn-primary">+ Aufgabe erstellen</button>
                </div>
                <div class="mb-4">
                    <select id="filter-tasks">
                        <option value="all">Alle Aufgaben</option>
                        <option value="my">Meine Aufgaben</option>
                        <option value="week">N√§chste Woche f√§llig</option>
                        <option value="open">Nur offene</option>
                    </select>
                </div>
                <div class="card">
                    <table id="tasks-table">
                        <thead>
                            <tr>
                                <th>Aufgabe</th>
                                <th>Verantwortlich</th>
                                <th>F√§llig</th>
                                <th>Status</th>
                                <th>Priorit√§t</th>
                                <th>Aktionen</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Dynamic content -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="tab-gantt" class="tab-content hidden">
                <div class="flex" style="justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h3 class="text-lg font-semibold">Gantt-Zeitplan &amp; Kritischer Pfad</h3>
                    <div class="flex gap-4">
                        <button id="btn-export-gantt-pdf" class="btn" onclick="UI.exportGanttToPDF()">üì• Gantt-Zeitplan als PDF</button>
                        <button class="btn btn-primary" onclick="UI.showAddTaskModal()">+ Aufgabe hinzuf√ºgen</button>
                    </div>
                </div>

                <!-- Critical Path Info -->
                <div id="critical-path-info" class="card mb-6">
                    <!-- Dynamic content -->
                </div>

                <!-- Filter & View Options -->
                <div class="card mb-6">
                    <div class="grid grid-cols-3 gap-4">
                        <div>
                            <label class="text-sm font-medium">Ansicht</label>
                            <select id="gantt-view-mode">
                                <option value="Month" selected="">Monat</option>
                                <option value="Quarter">Quartal</option>
                            </select>
                        </div>
                        <div>
                            <label class="text-sm font-medium">Filter</label>
                            <select id="gantt-filter">
                                <option value="all">Alle Aufgaben</option>
                                <option value="critical">Nur kritischer Pfad</option>
                                <option value="delayed">Nur verz√∂gerte</option>
                                <option value="in_progress">Nur in Arbeit</option>
                            </select>
                        </div>
                        <div>
                            <label class="text-sm font-medium">Verantwortlich</label>
                            <select id="gantt-filter-responsible">
                                <option value="">Alle</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Gantt Chart -->
                <div class="card">
                    <div id="gantt-chart-container" style="overflow-x: auto;"></div>
                </div>

                <!-- Task Details Table -->
                <div class="card mt-6">
                    <h4 class="font-semibold mb-4">Aufgaben-Details mit Pufferzeiten</h4>
                    <div style="overflow-x: auto;">
                        <table id="gantt-tasks-table">
                            <thead>
                                <tr>
                                    <th>Aufgabe</th>
                                    <th>Verantwortlich</th>
                                    <th>Start</th>
                                    <th>Ende</th>
                                    <th>Dauer</th>
                                    <th>Slack</th>
                                    <th>Status</th>
                                    <th>Priorit√§t</th>
                                    <th>Aktionen</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Dynamic content -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="tab-team" class="tab-content hidden">
                <div class="flex" style="justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <div>
                        <h3 class="text-lg font-semibold">Projektteam</h3>
                        <p class="text-sm" style="color: var(--text-secondary); margin-top: 0.25rem;">
                            Teammitglieder aus dem globalen Ressourcenpool diesem Projekt zuweisen
                        </p>
                    </div>
                    <button class="btn btn-primary" onclick="UI.showAddProjectTeamMemberModal()">
                        + Mitglied zum Projektteam hinzuf√ºgen
                    </button>
                </div>

                <!-- Project Team Members Table -->
                <div class="card">
                    <table id="project-team-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Globale Rolle</th>
                                <th>Rolle im Projekt</th>
                                <th>Verf√ºgbare Kapazit√§t</th>
                                <th>Aktuelle Buchung</th>
                                <th>Aktionen</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Dynamic content -->
                        </tbody>
                    </table>
                </div>

                <div class="p-4 mt-4" style="background: var(--bg-tertiary); border-radius: 0.5rem; border-left: 4px solid var(--primary);">
                    <p class="text-sm" style="color: var(--text-secondary);">
                        <strong>‚ÑπÔ∏è Hinweis:</strong> Nur Mitglieder des Projektteams k√∂nnen in diesem Projekt gebucht werden und als Verantwortliche f√ºr Aufgaben zugewiesen werden.
                        Beim Entfernen eines Mitglieds aus dem Projektteam werden alle zugeh√∂rigen Buchungen gel√∂scht.
                    </p>
                </div>
            </div>

            <div id="tab-resources" class="tab-content hidden">
                <h3 class="text-lg font-semibold mb-4">Ressourcenplanung</h3>

                <!-- Bookings Container -->
                <div id="resources-bookings-container"></div>
            </div>
        </div>
        <footer class="app-footer">
            <div class="app-footer-inner">
                <span>¬© <span id="app-footer-year"></span> Lukas Fritschi. All rights reserved.</span>
                <a href="/impressum.html">Impressum</a>
            </div>
        </footer>
    </div>
	<script src="dataService.js"></script>
	<script src="state.js"></script>
	<script src="ui.js"></script>
	<script src="main.js"></script>
</body></html>
